---
title: "Association of linguistic input at age 6 months and mental health symptoms at age 18 months"
author: "Fran Querdasi & Lucy King"
output: html_document
---

# Environment
```{r setup, include=FALSE}
# Libraries
library(tidyverse)
library(Hmisc)
library(car)
library(corrr)
library(corrplot)
library(nlme)
library(ggpubr)
library(modelr)
library(gvlma)

# Files 

## Fran file paths
#crisys_file <- "~/Desktop/lena_18mo_symptoms/Data/crisys_6mo_20190430.csv"
#q_18mo_file <- "~/Desktop/lena_18mo_symptoms/Data/q_18month_scores_20190510.csv"
#q_18mo_ages_file <- "~/Desktop/lena_18mo_symptoms/Data/q_18month_ages.csv"
#demographics_file <- "~/Desktop/lena_18mo_symptoms/Data/demographics_20190510.csv"
#lena_followup_and_data_file <- "~/Desktop/lena_18mo_symptoms/Data/lena_followup_and_data_20190510.csv"
#baby_raceth_file <- "~/Desktop/lena_18mo_symptoms/Data/baby_race_ethnicity.csv"
#ibq_file <- "~/Desktop/lena_18mo_symptoms/Data/ibq_scored_20190510.csv"


## Lucy file paths
crisys_file <- "~/Desktop/BABIES/lena_symptoms/data_final/crisys_6mo_20190726.csv"
q_18mo_file <- "~/Desktop/BABIES/lena_symptoms/data_final/q_18month_scores_20190726.csv"
q_18mo_ages_file <- "~/Desktop/BABIES/lena_symptoms/data_final/q_18month_ages.csv"
demographics_file <- "~/Desktop/BABIES/lena_symptoms/data_final/demographics_20190726.csv"
lena_followup_and_data_file <- "~/Desktop/BABIES/lena_symptoms/data_final/lena_followup_and_data_20190726.csv"
baby_raceth_file <- "~/Desktop/BABIES/lena_symptoms/data_final/baby_race_ethnicity.csv"
ibq_file <- "~/Desktop/BABIES/lena_symptoms/data_final/ibq_scored_20190726.csv"


# Functions
source("identify_outliers_histogram.R")
source("winsorize.R")
```

# Read in and join data
```{r}
d0 <-
  read_csv(lena_followup_and_data_file) %>% 
  left_join(
    read_csv(q_18mo_file) %>% 
      select(
        ID, 
        itsea_symptoms,
        baby_age_18month
      ), 
    by = "ID"
  ) %>% 
  left_join(
    read_csv(crisys_file),
    by = "ID"
  ) %>% 
  left_join(
    read_csv(demographics_file) %>% 
      select(
        ID,
        education,
        annual_income,
        income_needs,
        male,
        mom_age_6mo_visit,
        mom_race,
        mom_ethnicity,
        child_race,
        childrace_describe,
        child_ethnicity
      ),
    by = "ID"
  ) %>% 
  left_join(
    read_csv(ibq_file) %>% 
      select(
        ID,
        SUR,
        NEG
      ),
    by = "ID"
  ) %>% 
  mutate(
    day = as.factor(day),
    day_type = as.factor(day_type),
    male = as.factor(male)
  ) 
```

## Select only Day 1 recordings
```{r}
d0_d1 <-
  d0 %>% 
  filter(day == 1)
```


# Descriptive statistics 

Race:
1, American Indian or Alaska Native
2, Asian
3, Black or African American
4, Native Hawaiian or Other Pacific Islander
5, White
6, Other

Education:
0, No schooling completed
2, Nursery school to 8th grade
3, Some high school, no diploma
4, High school graduate, diploma or the equivalent (i.e. GED)
5, Some college credit, no degree
6, Trade/technical/vocational training
7, Associate degree
8, Bachelor's degree
9, Graduate degree
10, Other

Income:
1, $0-5,000
2, $5,001-15,000
3, $15,001-30,000
4, $30,001-60,000
5, $60,001-90,000
6, $90,001-150,000
7, Greater than $150,000

## Missing data 
```{r}
d0_d1 %>% 
  count(!is.na(awc_daily_rate))

d0_d1 %>% 
  count(!is.na(awc_daily_rate), !is.na(itsea_symptoms))

d0_d1 <-
  d0_d1 %>% 
  filter(!is.na(itsea_symptoms))
```

## Descriptive statistics 

```{r}
d0_d1 %>% 
  summarize_at(
    vars(
      baby_age_18month,
      baby_age_lena,
      NEG,
      ctc_daily_rate,
      ctc_prop,
      awc_daily_rate,
      awc_prop,
      itsea_symptoms,
      crisys_total_6mo,
      duration,
      mom_age_6mo_visit,
      percent_mother
    ), 
    list(~mean, ~sd, ~min, ~max), na.rm = TRUE)

d0_d1$baby_age_18month

d0_d1 %>% 
  filter(baby_age_18month < 7)

```

```{r}
#counts and percentages for categorical variables (education, ethnicity, race, income)

#income
lena_18mo_sym_complete %>% 
  distinct(ID, annual_income) %>% 
  count(annual_income) %>% 
  mutate(per = n / sum(n)) %>% 
  arrange(desc(annual_income))

lena_18mo_sym_complete %>% 
  distinct(ID, income_needs) %>% 
  count(income_needs < 1) %>% 
  mutate(per = n / sum(n))

#mom and child ethnicity
lena_18mo_sym_complete %>% 
  distinct(ID, mom_ethnicity) %>% 
  count(mom_ethnicity) %>% 
  mutate(per = n / sum(n))

lena_18mo_sym_complete %>% 
  distinct(ID, child_ethnicity) %>%
  count(child_ethnicity) %>% 
  mutate(per = n / sum(n))

#mom and child race
lena_18mo_sym_complete %>% 
  distinct(ID, mom_race) %>%
  count(mom_race) %>% 
  mutate(per = n / sum(n)) %>% 
  arrange(desc(per))

lena_18mo_sym_complete %>% 
  distinct(ID, child_race) %>%
  count(child_race) %>% 
  mutate(per = n / sum(n)) %>% 
  arrange(desc(per))

#mom education
lena_18mo_sym_complete %>% 
  distinct(ID, education) %>%
  count(education) %>% 
  mutate(per = n / sum(n)) %>% 
  arrange(desc(per))
```

## Distributions and identification of outliers key variables
```{r}

lena_18mo_sym_complete %>% 
  count(day_type)

lena_18mo_sym_df %>% 
  count(day)

identify_outliers_hist(
  data = lena_18mo_sym_df %>% 
    distinct(ID, income_needs),
  x = income_needs
)

identify_outliers_hist(
  data = lena_18mo_sym_df %>% 
    distinct(ID, education),
  x = education
)

identify_outliers_hist(
  data = lena_18mo_sym_df,
  x = baby_age_lena
) +
  facet_wrap(. ~day, scale = "free")

identify_outliers_hist(
  data = lena_18mo_sym_df,
  x = duration
) +
  facet_wrap(. ~day, scale = "free")


identify_outliers_hist(
  data = lena_18mo_sym_df,
  x = awc_prop
) +
  facet_wrap(. ~day, scale = "free")


identify_outliers_hist(
  data = lena_18mo_sym_df,
  x = ctc_prop
) +
  facet_wrap(. ~day, scale = "free")

identify_outliers_hist(
  data = lena_18mo_sym_df,
  x = ctc_daily_rate
) +
  facet_wrap(. ~day, scale = "free")


identify_outliers_hist(
  data = lena_18mo_sym_df,
  x = awc_daily_rate
) +
  facet_wrap(. ~day, scale = "free")

identify_outliers_hist(
  data = lena_18mo_sym_df,
  x = cvc_daily_rate
) +
  facet_wrap(. ~day, scale = "free")

identify_outliers_hist(
  data = lena_18mo_sym_df %>% 
    distinct(ID, itsea_symptoms),
  x = log(itsea_symptoms)
) 

identify_outliers_hist(
  data = lena_18mo_sym_df %>% 
    distinct(ID, itsea_competence),
  x = itsea_competence
) 
```

## Winsorize variables with outliers > 3SD from mean
```{r}
lena_18mo_sym_df <-
  lena_18mo_sym_df %>% 
  mutate(
    ctc_daily_rate_win = winsorize(ctc_daily_rate, product = 3),
    cvc_daily_rate_win = winsorize(cvc_daily_rate, product = 3),
    awc_daily_rate_win = winsorize(awc_daily_rate, product = 3)
  )
```

## Descriptives for key variables of interest
```{r}
lena_18mo_sym_complete %>% 
  #group_by(day) %>% 
  summarise_at(
    vars(
      itsea_competence, 
      itsea_symptoms, 
      crisys_total_6mo_win, 
      crisys_total_6mo,
      awc_prop, 
      ctc_prop, 
      cvc_prop,
      ctc_daily_rate_win,
      awc_daily_rate_win,
      cvc_daily_rate_win
    ), 
    funs(
      mean, 
      sd, 
      min, 
      max
    ), 
    na.rm = TRUE
  )

#calculate concern scores for ITSEA
itsea_concern <-
  lena_18mo_sym_day1 %>% 
  left_join(
    read_csv(q_18mo_file) %>% 
      select(
        ID,
        itsea_symptoms,
        itsea_competence,
        itsea_activity,
        itsea_agress,
        itsea_depp,
        itsea_gad,
        itsea_negemo
      ) 
    ) %>% 
      filter(
        !is.na(itsea_symptoms)
      )
```

## Correlation tables
```{r}
correlations_day1 <-
  lena_18mo_sym_df %>% 
  filter(day == 1) %>% 
  select(
    symptoms = itsea_symptoms,
    "child age at 18 month assessment" = baby_age_18month,
    "child age at 6 month assessment" = baby_age_lena,
    "mother age at 6 month assessment" = mom_age_6mo_visit,
    "income to needs ratio" = income_needs,
    "mother's recent stress and trauma" = crisys_neg_total_6mo_win,
    "LENA recording duration" = duration,
    "AW quantity" = awc_daily_rate_win,
    "CT quantity" = ctc_daily_rate_win,
    "AW consistency" = awc_prop,
    "CT consistency" = ctc_prop,
    "IBQ Surgency Score" = SUR,
    "IBQ Negative Affectivity Score" = NEG
  ) 

correlations_day1 %>% 
  correlate(method = "pearson") %>% 
  fashion()
```

```{r}
correlations_day2 <-
  lena_18mo_sym_df %>% 
  filter(day == 2) %>% 
  select(
   symptoms = itsea_symptoms,
    "child age at 18 month assessment" = baby_age_18month,
    "child age at 6 month assessment" = baby_age_lena,
    "mother age at 6 month assessment" = mom_age_6mo_visit,
    "income to needs ratio" = income_needs,
    "mother's recent stress and trauma" = crisys_neg_total_6mo_win,
    "LENA recording duration" = duration,
    "AW quantity" = awc_daily_rate_win,
    "CT quantity" = ctc_daily_rate_win,
    "AW consistency" = awc_prop,
    "CT consistency" = ctc_prop,
    "IBQ Surgency Score" = SUR,
    "IBQ Negative Affectivity Score" = NEG
  ) 

correlations_day2 %>% 
  correlate(method = "pearson") %>% 
  fashion()
```


## T-tests by day of recording and day type

```{r}
t.test(lena_18mo_sym_df$awc_daily_rate ~ lena_18mo_sym_df$day)

t.test(lena_18mo_sym_df$ctc_daily_rate ~ lena_18mo_sym_df$day)

t.test(lena_18mo_sym_df$cvc_daily_rate ~ lena_18mo_sym_df$day)

t.test(lena_18mo_sym_df$awc_prop ~ lena_18mo_sym_df$day)

t.test(lena_18mo_sym_df$ctc_prop ~ lena_18mo_sym_df$day)

t.test(lena_18mo_sym_df$cvc_prop ~ lena_18mo_sym_df$day)

```

# Results 

## Associations of linguistinc input with ITSEA symptoms 

## Effect code categorical variables

```{r}
contrasts(lena_18mo_sym_df$day) = c(-1, 1)
contrasts(lena_18mo_sym_df$day_type) = c(-1, 1)
contrasts(lena_18mo_sym_df$male) = c(-1, 1)
```

## Create Day 1 and Day 2 data frames
```{r}
lena_18mo_sym_day1 <-
  lena_18mo_sym_df %>% 
  filter(day == 1)

lena_18mo_sym_day2 <-
  lena_18mo_sym_df %>% 
  filter(day == 2)
```


#### Formal model fitting 
```{r}
symp <-
  lm(
    itsea_symptoms ~ 1,
    data = lena_18mo_sym_day1
  )

# baby age at lena
symp_babyage <-
  lm(
    itsea_symptoms ~ 
      scale(baby_age_lena, scale = FALSE),
    data = lena_18mo_sym_day1
  )
anova(symp, symp_babyage)

# mom age at lena
symp_momage <-
  lm(
    itsea_symptoms ~ 
      scale(baby_age_lena, scale = FALSE) + 
      scale(mom_age_6mo_visit, scale = FALSE),
    data = lena_18mo_sym_day1
  )
#anova(symp_babyage, symp_momage)

# day type
symp_daytype <-
  lm(
    itsea_symptoms ~ 
      scale(baby_age_lena, scale = FALSE) + 
      scale(mom_age_6mo_visit, scale = FALSE) +
      day_type,
    data = lena_18mo_sym_day1
  )
#anova(symp_momage, symp_daytype)

# duration
symp_duration <-
  lm(
    itsea_symptoms ~ 
      scale(baby_age_lena, scale = FALSE) + 
      scale(mom_age_6mo_visit, scale = FALSE) +
      scale(duration, scale = FALSE),
    data = lena_18mo_sym_day1
  )
#anova(symp_momage, symp_duration)

# sex
symp_sex <-
  lm(
    itsea_symptoms ~ 
      scale(baby_age_lena, scale = FALSE) + 
      scale(mom_age_6mo_visit, scale = FALSE) +
      male,
    data = lena_18mo_sym_day1
  )
#anova(symp_momage, symp_sex)

# NEG temperament
lena_18mo_sym_day1_temperament <- 
  lena_18mo_sym_day1 %>% 
  filter(!is.na(NEG))

symp_momage_temperament <-
  lm(
    itsea_symptoms ~ 
      scale(baby_age_lena, scale = FALSE) + 
      scale(mom_age_6mo_visit, scale = FALSE),
    data = lena_18mo_sym_day1_temperament
  )

symp_NEG <-
  lm(
    itsea_symptoms ~ 
      scale(baby_age_lena, scale = FALSE) + 
      scale(mom_age_6mo_visit, scale = FALSE) +
      scale(NEG, scale = FALSE),
    data = lena_18mo_sym_day1_temperament
  )

#anova(symp_momage_temperament, symp_NEG)

# SUR temperament
symp_SUR <-
  lm(
    itsea_symptoms ~ 
      scale(baby_age_lena, scale = FALSE) + 
      scale(mom_age_6mo_visit, scale = FALSE) +
      scale(NEG, scale = FALSE) +
      scale(SUR, scale = FALSE),
    data = lena_18mo_sym_day1_temperament
  )

#anova(symp_NEG, symp_SUR)

# CVC rate
symp_CVC <-
  lm(
    itsea_symptoms ~ 
      scale(baby_age_lena, scale = FALSE) + 
      scale(mom_age_6mo_visit, scale = FALSE) +
      scale(NEG, scale = FALSE) +
      scale(cvc_daily_rate_win, scale = FALSE),
    data = lena_18mo_sym_day1_temperament
  )

#anova(symp_NEG, symp_CVC)
```

```{r}
final_base_model <- 
  lm(
    itsea_symptoms~ 
      scale(baby_age_lena, scale = FALSE) + 
      scale(mom_age_6mo_visit, scale = FALSE) +
      scale(NEG, scale = FALSE),
    data = lena_18mo_sym_day1 
  )

crisys_model <- 
  lm(
    itsea_symptoms~ 
      scale(baby_age_lena, scale = FALSE) + 
      scale(mom_age_6mo_visit, scale = FALSE) +
      scale(NEG, scale = FALSE) +
      scale(crisys_neg_total_6mo_win, scale = FALSE),
    data = lena_18mo_sym_day1 
  )

R_squared_base <- summary(final_base_model)$r.squared
R_squared_crisys <- summary(crisys_model)$r.squared
R_chg_crisys <- R_squared_crisys - R_squared_base
```

### Dependability

### AWC dependability day 1
```{r}
sym_awcprop <- 
  lm(
    itsea_symptoms~ 
      scale(awc_prop, scale = FALSE) +
      scale(crisys_neg_total_6mo_win, scale = FALSE) +
      scale(baby_age_lena, scale = FALSE) + 
      scale(mom_age_6mo_visit, scale = FALSE) +
      scale(NEG, scale = FALSE),
    data = lena_18mo_sym_day1 
  )

summary(sym_awcprop)

sym_awcprop_int <- 
  lm(
    itsea_symptoms~ 
      scale(awc_prop, scale = FALSE) * scale(crisys_neg_total_6mo_win, scale = FALSE) +
      scale(baby_age_lena, scale = FALSE) + 
      scale(mom_age_6mo_visit, scale = FALSE) +
      scale(NEG, scale = FALSE),
    data = lena_18mo_sym_day1 
  )

summary(sym_awcprop_int)
```

### CTC dependability day 1 
```{r}
sym_ctcprop <- 
  lm(
    itsea_symptoms~ 
      scale(ctc_prop, scale = FALSE) +
      scale(crisys_neg_total_6mo_win, scale = FALSE) +
      scale(baby_age_lena, scale = FALSE) + 
      scale(mom_age_6mo_visit, scale = FALSE) +
      scale(NEG, scale = FALSE),
    data = lena_18mo_sym_day1 
  )
summary(sym_ctcprop)

R_chg_ctcprop <- summary(sym_ctcprop)$r.squared - R_squared_crisys

sym_ctcprop_int <- 
  lm(
    itsea_symptoms~ 
      scale(ctc_prop, scale = FALSE) * scale(crisys_neg_total_6mo_win, scale = FALSE) +
      scale(baby_age_lena, scale = FALSE) + 
      scale(mom_age_6mo_visit, scale = FALSE) +
      scale(NEG, scale = FALSE),
    data = lena_18mo_sym_day1 
  )
```

```{r}
#assessing outliers
outlierTest(sym_ctcprop) # Bonferonni p-value for most extreme obs
qqPlot(sym_ctcprop, main = "QQ Plot") #qq plot for studentized resid 

# Evaluate Collinearity
vif(sym_ctcprop) # variance inflation factors 

# Global test of model assumptions
gvlma(sym_ctcprop) 

# To address skeqness, evaluate model with sqrt-transform of itsea_symptoms
symsqrt_ctcprop <- 
  lm(
    sqrt(itsea_symptoms)~ 
      scale(ctc_prop, scale = FALSE) +
      scale(crisys_neg_total_6mo_win, scale = FALSE) +
      scale(baby_age_lena, scale = FALSE) + 
      scale(mom_age_6mo_visit, scale = FALSE) +
      scale(NEG, scale = FALSE),
    data = lena_18mo_sym_day1 
  )
summary(symsqrt_ctcprop)

gvlma(symsqrt_ctcprop) 
```


### Rate of input

### AWC rate day 1 
```{r}
sym_awc_rate <- 
  lm(
    itsea_symptoms~ 
      scale(awc_daily_rate_win, scale = FALSE) +
      scale(crisys_neg_total_6mo_win, scale = FALSE) +
      scale(baby_age_lena, scale = FALSE) + 
      scale(mom_age_6mo_visit, scale = FALSE) +
      scale(NEG, scale = FALSE),
    data = lena_18mo_sym_day1 
  )
summary(sym_awc_rate)

R_chg_awcrate <- summary(sym_awc_rate)$r.squared - R_squared_crisys

sym_awc_rate_int <- 
  lm(
    itsea_symptoms~ 
      scale(awc_daily_rate_win, scale = FALSE) * scale(crisys_neg_total_6mo_win, scale = FALSE) +
      scale(baby_age_lena, scale = FALSE) + 
      scale(mom_age_6mo_visit, scale = FALSE) +
      scale(NEG, scale = FALSE),
    data = lena_18mo_sym_day1 
  )

summary(sym_awc_rate_int)
```

```{r}
#assessing outliers
outlierTest(sym_awc_rate) # Bonferonni p-value for most extreme obs
qqPlot(sym_awc_rate, main = "QQ Plot") #qq plot for studentized resid 

# Evaluate Collinearity
vif(sym_awc_rate) # variance inflation factors 

# Global test of model assumptions
gvlma(sym_awc_rate) 
```

### CTC rate day 1 
```{r}
sym_ctc_rate <- 
  lm(
    itsea_symptoms~ 
      scale(ctc_daily_rate_win, scale = FALSE) +
      scale(crisys_neg_total_6mo_win, scale = FALSE) +
      scale(baby_age_lena, scale = FALSE) + 
      scale(mom_age_6mo_visit, scale = FALSE) +
      scale(NEG, scale = FALSE),
    data = lena_18mo_sym_day1 
  )
summary(sym_ctc_rate)

R_squared_ctcrate <- summary(sym_ctc_rate)$r.squared 
R_chg_ctcrate <- R_squared_ctcrate - R_squared_crisys

sym_ctc_rate_int <- 
  lm(
    itsea_symptoms~ 
      scale(ctc_daily_rate_win, scale = FALSE) * scale(crisys_neg_total_6mo_win, scale = FALSE) +
      scale(baby_age_lena, scale = FALSE) + 
      scale(mom_age_6mo_visit, scale = FALSE) +
      scale(NEG, scale = FALSE),
    data = lena_18mo_sym_day1 
  )

summary(sym_ctc_rate_int)

R_chg_ctcrate_int <- summary(sym_ctc_rate_int)$r.squared - R_squared_ctcrate
```

```{r}
#assessing outliers
outlierTest(sym_ctc_rate_int) # Bonferonni p-value for most extreme obs
qqPlot(sym_ctc_rate_int, main = "QQ Plot") #qq plot for studentized resid 

# Evaluate Collinearity
vif(sym_ctc_rate_int) # variance inflation factors 

# Global test of model assumptions
gvlma(sym_ctc_rate_int) 


# To address skeqness, evaluate model with sqrt-transform of itsea_symptoms
symsqrt_ctc_rate_int <- 
  lm(
    sqrt(itsea_symptoms) ~ 
      scale(ctc_daily_rate_win, scale = FALSE) * scale(crisys_neg_total_6mo_win, scale = FALSE) +
      scale(baby_age_lena, scale = FALSE) + 
      scale(mom_age_6mo_visit, scale = FALSE) +
      scale(NEG, scale = FALSE),
    data = lena_18mo_sym_day1 
  )
summary(symsqrt_ctc_rate_int)

gvlma(symsqrt_ctc_rate_int) 
```

### Specificity of CTC rate effects

#### CTC rate day 1 when controlling for CVC rate

```{r}
sym_ctc_cvc_rate <- 
  lm(
    itsea_symptoms~ 
      scale(ctc_daily_rate_win, scale = FALSE) * scale(crisys_neg_total_6mo_win, scale = FALSE) +
      scale(baby_age_lena, scale = FALSE) + 
      scale(mom_age_6mo_visit, scale = FALSE) +
      scale(NEG, scale = FALSE) +
      scale(cvc_daily_rate_win, scale = FALSE),
    data = lena_18mo_sym_day1 
  )

summary(sym_ctc_cvc_rate)
```

#### CTC rate day 1 when controlling for CTC prop

```{r}
sym_ctc_ctcprop <- 
  lm(
    itsea_symptoms~ 
      scale(ctc_daily_rate_win, scale = FALSE) * scale(crisys_neg_total_6mo_win, scale = FALSE) +
      scale(baby_age_lena, scale = FALSE) + 
      scale(mom_age_6mo_visit, scale = FALSE) +
      scale(NEG, scale = FALSE) +
      scale(ctc_prop, scale = FALSE),
    data = lena_18mo_sym_day1 
  )

summary(sym_ctc_ctcprop)
```

#### CTC rate day 1 when controlling for AWC rate

```{r}
sym_ctc_awc <- 
  lm(
    itsea_symptoms~ 
      scale(ctc_daily_rate_win, scale = FALSE) * scale(crisys_neg_total_6mo_win, scale = FALSE) +
      scale(baby_age_lena, scale = FALSE) + 
      scale(mom_age_6mo_visit, scale = FALSE) +
      scale(NEG, scale = FALSE) +
      scale(awc_daily_rate_win, scale = FALSE),
    data = lena_18mo_sym_day1 
  )

summary(sym_ctc_awc)
```

### CTC rate simple effects
```{r}
sym_ctc_rate_lo <- 
  lm(
    itsea_symptoms ~ 
      I(scale(ctc_daily_rate_win, scale = FALSE) + sd(ctc_daily_rate_win, na.rm = TRUE)) * 
      scale(crisys_neg_total_6mo_win, scale = FALSE) +
      scale(baby_age_lena, scale = FALSE) + 
      scale(mom_age_6mo_visit, scale = FALSE) +
      scale(NEG, scale = FALSE),
    data = lena_18mo_sym_day1 
  )

summary(sym_ctc_rate_lo)

sym_ctc_rate_hi <- 
  lm(
    itsea_symptoms ~ 
      I(scale(ctc_daily_rate_win, scale = FALSE) - sd(ctc_daily_rate_win, na.rm = TRUE)) * 
      scale(crisys_neg_total_6mo_win, scale = FALSE) +
      scale(baby_age_lena, scale = FALSE) + 
      scale(mom_age_6mo_visit, scale = FALSE) +
      scale(NEG, scale = FALSE),
    data = lena_18mo_sym_day1 
  )
```

# Visualize significant effects

```{r}
theme_lena <-
  theme_minimal() +
  theme(
    panel.grid = element_blank(),
    plot.title = element_text(size = 18, hjust = .5),
    axis.title = element_text(size = 18),
    axis.text = element_text(size = 16),
    legend.title = element_text(size = 18), 
    legend.text = element_text(size = 16),
    legend.position = "bottom"
  )
  
```

# Main effect of CTC prop
```{r}
lena_18mo_sym_day1 <-
  lena_18mo_sym_day1 %>% 
  add_residuals(crisys_model, "symp_resid_crisys")

lena_18mo_sym_day1 %>% 
  ggplot(aes(ctc_prop, symp_resid_crisys)) +
    geom_point(size = 4) +
  geom_smooth(method = "lm", size = 3, se = FALSE) +
  scale_x_continuous(breaks = seq.int(0, .7, .1)) +
  labs(
    x = "Dependability of conversational turns at age 6 months",
    y = "Symptoms at age 18 months\n(residuals)"
  ) +
  theme_lena
  
```

# Main effect of AWC rate
```{r}
lena_18mo_sym_day1 %>% 
  ggplot(aes(awc_daily_rate_win, symp_resid_crisys)) +
    geom_point(size = 4) +
  geom_smooth(method = "lm", size = 3, se = FALSE) +
  scale_x_continuous(breaks = seq.int(300, 2500, 300)) +
  labs(
    x = "Adults words per hour at age 6 months",
    y = "Symptoms at age 18 months\n(residuals)"
  ) +
  theme_lena
  
```

# Main effect of CTC rate
```{r}
lena_18mo_sym_day1 %>% 
  ggplot(aes(ctc_daily_rate_win, symp_resid_crisys)) +
  geom_point(size = 4) +
  geom_smooth(method = "lm", size = 3, se = FALSE) +
  scale_x_continuous(breaks = seq.int(0, 60, 10)) +
  labs(
    x = "Conversational turns per hour at age 6 months",
    y = "Symptoms at age 18 months\n(residuals)"
  ) +
  theme_lena
  
```


```{r}
lena_18mo_sym_day1 <-
  lena_18mo_sym_day1 %>% 
  add_residuals(final_base_model, "sym_resid_cov")

lena_18mo_sym_day1 %>% 
  ggplot(
    aes(
      crisys_neg_total_6mo_win, 
      sym_resid_cov, 
      color = ctc_daily_rate_win > 25
    )
  ) +
  geom_point(size = 4) +
  geom_smooth(size = 3, method = "lm", se = FALSE) +
  scale_color_manual(
    labels = c("<25 CTs/hour", ">25 CTs/hour"),
    values = c("red", "blue")
  ) +
  scale_y_continuous(breaks = seq.int(-1, 1.5, .5)) +
  scale_x_continuous(breaks = seq.int(0, 10, 1)) +
  labs(
    color = NULL,
    x = "Maternal self-reported stressors\n at infant age 6 months",
    y = "Symptoms at age 18 months\n(residuals)"
  ) +
  theme_lena
```


# save dataframe used for analyses 
```{r}
#write_csv(lena_18mo_sym_df, "~/Desktop/lena_18mo_symptoms/data_for_analyses_20190519.csv")
write_csv(lena_18mo_sym_day1, "~/Desktop/lena_18mo_symptoms/Data/data_for_analyses_20190519.csv")
```
```

